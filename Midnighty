-- Fishing Script with GUI
-- Compatible with any fishing rod

local player = game:GetService("Players").LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local UIS = game:GetService("UserInputService")
local replicatedStorage = game:GetService("ReplicatedStorage")

-- Variables
local autoReelEnabled = false
local autoShakeEnabled = false
local autoCastEnabled = false
local rodCastDistance = 29 -- Default cast distance
local guiVisible = true

-- GUI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FishingHelper"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = player.PlayerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 200, 0, 160)
mainFrame.Position = UDim2.new(0.8, 0, 0.5, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = ScreenGui

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = Color3.fromRGB(40, 100, 160)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleText = Instance.new("TextLabel")
titleText.Name = "Title"
titleText.Size = UDim2.new(0.7, 0, 1, 0)
titleText.Position = UDim2.new(0, 10, 0, 0)
titleText.Text = "Fishing Helper"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.TextSize = 16
titleText.Font = Enum.Font.SourceSansBold
titleText.BackgroundTransparency = 1
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Parent = titleBar

-- Toggle Visibility Button
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0.2, 0, 1, 0)
toggleButton.Position = UDim2.new(0.8, 0, 0, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
toggleButton.Text = "X"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.TextSize = 16
toggleButton.Font = Enum.Font.SourceSansBold
toggleButton.BorderSizePixel = 0
toggleButton.Parent = titleBar

-- Auto Reel Button
local autoReelButton = Instance.new("TextButton")
autoReelButton.Name = "AutoReelButton"
autoReelButton.Size = UDim2.new(0.9, 0, 0, 25)
autoReelButton.Position = UDim2.new(0.05, 0, 0.25, 0)
autoReelButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
autoReelButton.Text = "Auto Reel: OFF"
autoReelButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoReelButton.TextSize = 14
autoReelButton.Font = Enum.Font.SourceSans
autoReelButton.BorderSizePixel = 0
autoReelButton.Parent = mainFrame

-- Auto Shake Button
local autoShakeButton = Instance.new("TextButton")
autoShakeButton.Name = "AutoShakeButton"
autoShakeButton.Size = UDim2.new(0.9, 0, 0, 25)
autoShakeButton.Position = UDim2.new(0.05, 0, 0.45, 0)
autoShakeButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
autoShakeButton.Text = "Auto Shake: OFF"
autoShakeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoShakeButton.TextSize = 14
autoShakeButton.Font = Enum.Font.SourceSans
autoShakeButton.BorderSizePixel = 0
autoShakeButton.Parent = mainFrame

-- Auto Cast Button
local autoCastButton = Instance.new("TextButton")
autoCastButton.Name = "AutoCastButton"
autoCastButton.Size = UDim2.new(0.9, 0, 0, 25)
autoCastButton.Position = UDim2.new(0.05, 0, 0.65, 0)
autoCastButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
autoCastButton.Text = "Auto Cast: OFF"
autoCastButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoCastButton.TextSize = 14
autoCastButton.Font = Enum.Font.SourceSans
autoCastButton.BorderSizePixel = 0
autoCastButton.Parent = mainFrame

-- Cast Distance Adjuster
local castDistance = Instance.new("TextBox")
castDistance.Name = "CastDistance"
castDistance.Size = UDim2.new(0.9, 0, 0, 25)
castDistance.Position = UDim2.new(0.05, 0, 0.85, 0)
castDistance.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
castDistance.Text = tostring(rodCastDistance)
castDistance.PlaceholderText = "Cast Distance"
castDistance.TextColor3 = Color3.fromRGB(255, 255, 255)
castDistance.TextSize = 14
castDistance.Font = Enum.Font.SourceSans
castDistance.BorderSizePixel = 0
castDistance.Parent = mainFrame

-- Function to get current fishing rod
local function getCurrentRod()
    local character = player.Character or player.CharacterAdded:Wait()
    
    -- Search through all character items for a rod
    for _, tool in pairs(character:GetChildren()) do
        if tool:IsA("Tool") and tool:FindFirstChild("events") and tool.events:FindFirstChild("cast") then
            return tool
        end
    end
    
    return nil
end

-- Function to perform a reel
local function performReel()
    local args = {
        [1] = 100,  -- Success rate (100 is perfect)
        [2] = true  -- Success boolean
    }
    
    -- Find the correct remote event
    local reelEvent = replicatedStorage.events:FindFirstChild("reelfinished") or 
                      replicatedStorage.events:FindFirstChild("reelfinished ") -- Note the space
    
    if reelEvent then
        reelEvent:FireServer(unpack(args))
    else
        print("Reel event not found!")
    end
end

-- Function to perform a cast
local function performCast()
    local rod = getCurrentRod()
    if not rod then
        print("No fishing rod equipped!")
        return
    end
    
    local castEvent = rod.events.cast
    if castEvent then
        local args = {
            [1] = rodCastDistance,
            [2] = 1  -- Power multiplier
        }
        castEvent:FireServer(unpack(args))
    else
        print("Cast event not found!")
    end
end

-- Function to perform a shake
local function performShake()
    local rod = getCurrentRod()
    if not rod then
        print("No fishing rod equipped!")
        return
    end
    
    -- Try different shake event names that might exist
    local shakeEvent = rod.events:FindFirstChild("shake") or 
                       rod.events:FindFirstChild("shaker") or
                       replicatedStorage.events:FindFirstChild("rodshake")
    
    if shakeEvent then
        shakeEvent:FireServer()
    else
        -- Try to directly modify rod properties if event doesn't exist
        if rod:FindFirstChild("Handle") then
            local originalCFrame = rod.Handle.CFrame
            for i = 1, 5 do
                rod.Handle.CFrame = originalCFrame * CFrame.new(math.random(-1, 1)/10, math.random(-1, 1)/10, math.random(-1, 1)/10)
                wait(0.05)
            end
            rod.Handle.CFrame = originalCFrame
        end
    end
end

-- Button Functions
toggleButton.MouseButton1Click:Connect(function()
    if guiVisible then
        autoReelButton.Visible = false
        autoShakeButton.Visible = false
        autoCastButton.Visible = false
        castDistance.Visible = false
        mainFrame.Size = UDim2.new(0, 200, 0, 30)
        toggleButton.Text = "O"
        toggleButton.BackgroundColor3 = Color3.fromRGB(60, 200, 60)
    else
        autoReelButton.Visible = true
        autoShakeButton.Visible = true
        autoCastButton.Visible = true
        castDistance.Visible = true
        mainFrame.Size = UDim2.new(0, 200, 0, 160)
        toggleButton.Text = "X"
        toggleButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    end
    guiVisible = not guiVisible
end)

autoReelButton.MouseButton1Click:Connect(function()
    autoReelEnabled = not autoReelEnabled
    autoReelButton.Text = "Auto Reel: " .. (autoReelEnabled and "ON" or "OFF")
    autoReelButton.BackgroundColor3 = autoReelEnabled and Color3.fromRGB(60, 180, 60) or Color3.fromRGB(60, 60, 60)
    
    -- Start the auto reel loop if enabled
    if autoReelEnabled then
        spawn(function()
            while autoReelEnabled do
                performReel()
                wait(1) -- Adjust timing as needed
            end
        end)
    end
end)

autoShakeButton.MouseButton1Click:Connect(function()
    autoShakeEnabled = not autoShakeEnabled
    autoShakeButton.Text = "Auto Shake: " .. (autoShakeEnabled and "ON" or "OFF")
    autoShakeButton.BackgroundColor3 = autoShakeEnabled and Color3.fromRGB(60, 180, 60) or Color3.fromRGB(60, 60, 60)
    
    -- Start the auto shake loop if enabled
    if autoShakeEnabled then
        spawn(function()
            while autoShakeEnabled do
                performShake()
                wait(0.5) -- Adjust timing as needed
            end
        end)
    end
end)

autoCastButton.MouseButton1Click:Connect(function()
    autoCastEnabled = not autoCastEnabled
    autoCastButton.Text = "Auto Cast: " .. (autoCastEnabled and "ON" or "OFF")
    autoCastButton.BackgroundColor3 = autoCastEnabled and Color3.fromRGB(60, 180, 60) or Color3.fromRGB(60, 60, 60)
    
    -- Start the auto cast loop if enabled
    if autoCastEnabled then
        spawn(function()
            while autoCastEnabled do
                performCast()
                wait(5) -- Adjust timing as needed
            end
        end)
    end
end)

castDistance.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        local newDistance = tonumber(castDistance.Text)
        if newDistance and newDistance > 0 then
            rodCastDistance = newDistance
            castDistance.Text = tostring(rodCastDistance)
        else
            castDistance.Text = tostring(rodCastDistance)
        end
    end
end)

-- Update character reference when player respawns
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
end)

-- Notification when script loads
local notification = Instance.new("TextLabel")
notification.Name = "Notification"
notification.Size = UDim2.new(0, 200, 0, 30)
notification.Position = UDim2.new(0.5, -100, 0.8, 0)
notification.Text = "Fishing Helper Loaded!"
notification.TextColor3 = Color3.fromRGB(255, 255, 255)
notification.TextSize = 16
notification.Font = Enum.Font.SourceSansBold
notification.BackgroundColor3 = Color3.fromRGB(40, 100, 160)
notification.BackgroundTransparency = 0.3
notification.BorderSizePixel = 0
notification.Parent = ScreenGui

game:GetService("Debris"):AddItem(notification, 3)

print("Fishing helper script loaded successfully!")
